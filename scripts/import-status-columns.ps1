param(
    [string]$projectId,
    [string]$schemaPath = ""
)

# Importar m√≥dulos corretamente
$modulesPath = Join-Path $PSScriptRoot "..\modules"
Import-Module (Join-Path $modulesPath "graphql-queries.psm1") -Force
Import-Module (Join-Path $modulesPath "utils.psm1") -Force
Import-Module (Join-Path $modulesPath "status-fields.psm1") -Force
Import-Module (Join-Path $modulesPath "SchemaManager.psm1") -Force

# Valida√ß√£o dos par√¢metros de entrada
if (-not $projectId) {
    Write-Error "O ID do projeto √© obrigat√≥rio. Use: .\import-status-columns.ps1 -projectId SEU_ID_AQUI"
    return
}

Write-Host "üöÄ Iniciando a configura√ß√£o das colunas (Status) para o projeto: $projectId"

# Carregar e validar o schema
$schemaInfo = Get-ProjectSchema -schemaPath $schemaPath
if (-not $schemaInfo) { return }
$schema = $schemaInfo.Schema

$statusFieldSchema = $schema.fields | Where-Object { $_.name -eq "Status" }
if (-not $statusFieldSchema) {
    Write-Error "O campo 'Status' n√£o foi encontrado no arquivo de schema."
    return
}

# Chama a fun√ß√£o modularizada para atualizar as colunas de status
Update-StatusColumns -projectId $projectId -statusFieldSchema $statusFieldSchema

